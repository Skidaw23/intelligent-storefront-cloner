{% comment %}
==============================================
INTELLIGENT STOREFRONT CLONER - COMPONENT FACTORY
==============================================
Factory pattern implementation for creating standardized components.
Ensures consistency across all theme elements and provides advanced
customization capabilities.

Features:
- Factory pattern for component creation
- Standardized component interfaces
- Advanced customization options
- Performance optimization
- Accessibility compliance
==============================================
{% endcomment %}

{% liquid
  comment 'Initialize Component Factory'
  assign factory_initialized = true
  assign factory_version = '1.0.0'
  assign factory_debug = settings.debug_mode
%}

{% comment %} COMPONENT TYPES REGISTRY {% endcomment %}
{% liquid
  assign component_types = 'button,card,banner,hero,slider,grid,form,navigation,testimonial,gallery,video,image,text,icon,badge,modal,tooltip,accordion,tabs,progress' | split: ','
  assign component_variants = 'primary,secondary,accent,outline,ghost,minimal,luxury,elegant,modern' | split: ','
  assign component_sizes = 'xs,sm,md,lg,xl,2xl' | split: ','
%}

{% comment %} FACTORY CONFIGURATION {% endcomment %}
{% liquid
  assign factory_config = blank
  assign factory_defaults = blank
  assign factory_cache = blank
%}

{% comment %} ================================= {% endcomment %}
{% comment %} BUTTON COMPONENT FACTORY {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign button_factory_type = button_factory_type | default: 'primary'
  assign button_factory_size = button_factory_size | default: 'md'
  assign button_factory_text = button_factory_text | default: 'Button'
  assign button_factory_url = button_factory_url | default: '#'
  assign button_factory_icon = button_factory_icon | default: ''
  assign button_factory_loading = button_factory_loading | default: false
  assign button_factory_disabled = button_factory_disabled | default: false
  assign button_factory_full_width = button_factory_full_width | default: false
  assign button_factory_attributes = button_factory_attributes | default: ''
  assign button_factory_classes = button_factory_classes | default: ''
  
  comment 'Generate button classes'
  assign button_classes = 'btn'
  assign button_classes = button_classes | append: ' btn--' | append: button_factory_type
  assign button_classes = button_classes | append: ' btn--' | append: button_factory_size
  
  if button_factory_full_width
    assign button_classes = button_classes | append: ' btn--full-width'
  endif
  
  if button_factory_loading
    assign button_classes = button_classes | append: ' btn--loading'
  endif
  
  if button_factory_disabled
    assign button_classes = button_classes | append: ' btn--disabled'
  endif
  
  if button_factory_classes != blank
    assign button_classes = button_classes | append: ' ' | append: button_factory_classes
  endif
%}

{% comment %} ================================= {% endcomment %}
{% comment %} CARD COMPONENT FACTORY {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign card_factory_variant = card_factory_variant | default: 'default'
  assign card_factory_elevation = card_factory_elevation | default: 'md'
  assign card_factory_padding = card_factory_padding | default: 'md'
  assign card_factory_border_radius = card_factory_border_radius | default: 'md'
  assign card_factory_has_header = card_factory_has_header | default: false
  assign card_factory_has_footer = card_factory_has_footer | default: false
  assign card_factory_interactive = card_factory_interactive | default: false
  assign card_factory_classes = card_factory_classes | default: ''
  
  comment 'Generate card classes'
  assign card_classes = 'card'
  assign card_classes = card_classes | append: ' card--' | append: card_factory_variant
  assign card_classes = card_classes | append: ' card--elevation-' | append: card_factory_elevation
  assign card_classes = card_classes | append: ' card--padding-' | append: card_factory_padding
  assign card_classes = card_classes | append: ' card--radius-' | append: card_factory_border_radius
  
  if card_factory_interactive
    assign card_classes = card_classes | append: ' card--interactive'
  endif
  
  if card_factory_classes != blank
    assign card_classes = card_classes | append: ' ' | append: card_factory_classes
  endif
%}

{% comment %} ================================= {% endcomment %}
{% comment %} HERO COMPONENT FACTORY {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign hero_factory_layout = hero_factory_layout | default: 'center'
  assign hero_factory_height = hero_factory_height | default: 'md'
  assign hero_factory_overlay = hero_factory_overlay | default: 'none'
  assign hero_factory_animation = hero_factory_animation | default: 'fade-in'
  assign hero_factory_parallax = hero_factory_parallax | default: false
  assign hero_factory_video = hero_factory_video | default: false
  assign hero_factory_classes = hero_factory_classes | default: ''
  
  comment 'Generate hero classes'
  assign hero_classes = 'hero'
  assign hero_classes = hero_classes | append: ' hero--' | append: hero_factory_layout
  assign hero_classes = hero_classes | append: ' hero--' | append: hero_factory_height
  assign hero_classes = hero_classes | append: ' hero--overlay-' | append: hero_factory_overlay
  assign hero_classes = hero_classes | append: ' hero--' | append: hero_factory_animation
  
  if hero_factory_parallax
    assign hero_classes = hero_classes | append: ' hero--parallax'
  endif
  
  if hero_factory_video
    assign hero_classes = hero_classes | append: ' hero--video'
  endif
  
  if hero_factory_classes != blank
    assign hero_classes = hero_classes | append: ' ' | append: hero_factory_classes
  endif
%}

{% comment %} ================================= {% endcomment %}
{% comment %} GRID COMPONENT FACTORY {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign grid_factory_columns = grid_factory_columns | default: 3
  assign grid_factory_gap = grid_factory_gap | default: 'md'
  assign grid_factory_responsive = grid_factory_responsive | default: true
  assign grid_factory_auto_fit = grid_factory_auto_fit | default: false
  assign grid_factory_align_items = grid_factory_align_items | default: 'stretch'
  assign grid_factory_classes = grid_factory_classes | default: ''
  
  comment 'Generate grid classes'
  assign grid_classes = 'grid'
  assign grid_classes = grid_classes | append: ' grid--columns-' | append: grid_factory_columns
  assign grid_classes = grid_classes | append: ' grid--gap-' | append: grid_factory_gap
  assign grid_classes = grid_classes | append: ' grid--align-' | append: grid_factory_align_items
  
  if grid_factory_responsive
    assign grid_classes = grid_classes | append: ' grid--responsive'
  endif
  
  if grid_factory_auto_fit
    assign grid_classes = grid_classes | append: ' grid--auto-fit'
  endif
  
  if grid_factory_classes != blank
    assign grid_classes = grid_classes | append: ' ' | append: grid_factory_classes
  endif
%}

{% comment %} ================================= {% endcomment %}
{% comment %} IMAGE COMPONENT FACTORY {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign image_factory_aspect_ratio = image_factory_aspect_ratio | default: 'auto'
  assign image_factory_object_fit = image_factory_object_fit | default: 'cover'
  assign image_factory_lazy_loading = image_factory_lazy_loading | default: true
  assign image_factory_responsive = image_factory_responsive | default: true
  assign image_factory_placeholder = image_factory_placeholder | default: true
  assign image_factory_classes = image_factory_classes | default: ''
  
  comment 'Generate image classes'
  assign image_classes = 'responsive-image'
  assign image_classes = image_classes | append: ' responsive-image--' | append: image_factory_aspect_ratio
  assign image_classes = image_classes | append: ' responsive-image--' | append: image_factory_object_fit
  
  if image_factory_lazy_loading
    assign image_classes = image_classes | append: ' responsive-image--lazy'
  endif
  
  if image_factory_placeholder
    assign image_classes = image_classes | append: ' responsive-image--placeholder'
  endif
  
  if image_factory_classes != blank
    assign image_classes = image_classes | append: ' ' | append: image_factory_classes
  endif
%}

{% comment %} ================================= {% endcomment %}
{% comment %} COMPONENT VALIDATION {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign validate_component_type = validate_component_type | default: ''
  assign component_is_valid = false
  
  if component_types contains validate_component_type
    assign component_is_valid = true
  endif
%}

{% comment %} ================================= {% endcomment %}
{% comment %} PERFORMANCE OPTIMIZATION {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign optimize_component_loading = optimize_component_loading | default: true
  assign component_critical_css = component_critical_css | default: false
  assign component_preload_assets = component_preload_assets | default: false
%}

{% comment %} ================================= {% endcomment %}
{% comment %} ACCESSIBILITY FEATURES {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign a11y_component_role = a11y_component_role | default: ''
  assign a11y_component_label = a11y_component_label | default: ''
  assign a11y_component_describedby = a11y_component_describedby | default: ''
  assign a11y_component_live = a11y_component_live | default: ''
%}

{% comment %} ================================= {% endcomment %}
{% comment %} COMPONENT ANALYTICS {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  assign analytics_component_track = analytics_component_track | default: false
  assign analytics_component_event = analytics_component_event | default: ''
  assign analytics_component_category = analytics_component_category | default: ''
%}

{% comment %} ================================= {% endcomment %}
{% comment %} FACTORY UTILITIES {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% liquid
  comment 'Generate unique component ID'
  assign generate_component_id = generate_component_id | default: ''
  assign component_unique_id = generate_component_id | append: '-' | append: 'now' | append: '-' | append: forloop.index
  
  comment 'Merge component attributes'
  assign merge_attributes_base = merge_attributes_base | default: ''
  assign merge_attributes_custom = merge_attributes_custom | default: ''
  assign merged_attributes = merge_attributes_base | append: ' ' | append: merge_attributes_custom
%}

{% comment %} ================================= {% endcomment %}
{% comment %} FACTORY CSS GENERATION {% endcomment %}
{% comment %} ================================= {% endcomment %}
<style>
  /* Component Factory Base Styles */
  .component-factory-base {
    --factory-primary-color: rgb(var(--color-button));
    --factory-secondary-color: rgb(var(--color-foreground));
    --factory-background-color: rgb(var(--color-background));
    --factory-border-color: rgba(var(--color-foreground), 0.1);
    --factory-text-color: rgb(var(--color-foreground));
    --factory-border-radius-sm: 4px;
    --factory-border-radius-md: 8px;
    --factory-border-radius-lg: 12px;
    --factory-spacing-sm: 0.5rem;
    --factory-spacing-md: 1rem;
    --factory-spacing-lg: 2rem;
    --factory-elevation-sm: 0 2px 4px rgba(0,0,0,0.1);
    --factory-elevation-md: 0 4px 8px rgba(0,0,0,0.12);
    --factory-elevation-lg: 0 8px 16px rgba(0,0,0,0.16);
    --factory-transition: all 0.2s ease-in-out;
  }

  /* Button Factory Styles */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: var(--factory-spacing-sm) var(--factory-spacing-md);
    border: 1px solid transparent;
    border-radius: var(--factory-border-radius-md);
    font-size: 1rem;
    font-weight: 500;
    text-decoration: none;
    cursor: pointer;
    transition: var(--factory-transition);
    position: relative;
  }

  .btn--primary {
    background-color: var(--factory-primary-color);
    color: rgb(var(--color-button-text));
  }

  .btn--secondary {
    background-color: transparent;
    color: var(--factory-primary-color);
    border-color: var(--factory-primary-color);
  }

  .btn--ghost {
    background-color: transparent;
    color: var(--factory-text-color);
  }

  .btn--sm {
    padding: calc(var(--factory-spacing-sm) * 0.75) var(--factory-spacing-sm);
    font-size: 0.875rem;
  }

  .btn--lg {
    padding: var(--factory-spacing-md) var(--factory-spacing-lg);
    font-size: 1.125rem;
  }

  .btn--full-width {
    width: 100%;
  }

  .btn--loading::after {
    content: '';
    position: absolute;
    width: 1rem;
    height: 1rem;
    border: 2px solid transparent;
    border-top: 2px solid currentColor;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Card Factory Styles */
  .card {
    background: var(--factory-background-color);
    border: 1px solid var(--factory-border-color);
    border-radius: var(--factory-border-radius-md);
    overflow: hidden;
    transition: var(--factory-transition);
  }

  .card--elevation-sm {
    box-shadow: var(--factory-elevation-sm);
  }

  .card--elevation-md {
    box-shadow: var(--factory-elevation-md);
  }

  .card--elevation-lg {
    box-shadow: var(--factory-elevation-lg);
  }

  .card--interactive:hover {
    transform: translateY(-2px);
    box-shadow: var(--factory-elevation-lg);
  }

  /* Grid Factory Styles */
  .grid {
    display: grid;
    width: 100%;
  }

  .grid--columns-1 { grid-template-columns: 1fr; }
  .grid--columns-2 { grid-template-columns: repeat(2, 1fr); }
  .grid--columns-3 { grid-template-columns: repeat(3, 1fr); }
  .grid--columns-4 { grid-template-columns: repeat(4, 1fr); }

  .grid--gap-sm { gap: var(--factory-spacing-sm); }
  .grid--gap-md { gap: var(--factory-spacing-md); }
  .grid--gap-lg { gap: var(--factory-spacing-lg); }

  .grid--responsive {
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }

  /* Image Factory Styles */
  .responsive-image {
    max-width: 100%;
    height: auto;
    display: block;
  }

  .responsive-image--lazy {
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .responsive-image--lazy.loaded {
    opacity: 1;
  }

  /* Factory Debug Styles */
  {% if settings.debug_mode %}
    .component-factory-debug {
      position: relative;
    }

    .component-factory-debug::before {
      content: attr(data-component-type);
      position: absolute;
      top: 0;
      left: 0;
      background: #ff6b6b;
      color: white;
      padding: 2px 6px;
      font-size: 10px;
      z-index: 1000;
      font-family: monospace;
    }
  {% endif %}
</style>

{% comment %} ================================= {% endcomment %}
{% comment %} DEBUG AND DEVELOPMENT {% endcomment %}
{% comment %} ================================= {% endcomment %}
{% if factory_debug %}
  <script>
    console.log('🏭 Component Factory Loaded');
    console.log('🧩 Available Components:', {{ component_types | json }});
    console.log('🎨 Component Variants:', {{ component_variants | json }});
    console.log('📏 Component Sizes:', {{ component_sizes | json }});
    console.log('⚡ Factory Version:', '{{ factory_version }}');
  </script>
{% endif %}