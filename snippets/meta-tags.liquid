{%- comment -%}
  Royal Equips Meta Tags
  Comprehensive SEO and social media optimization
{%- endcomment -%}

{%- assign og_title = page_title -%}
{%- assign og_url = canonical_url -%}
{%- assign og_type = 'website' -%}
{%- assign og_description = page_description | default: shop.description | default: shop.name -%}
{%- assign og_image = settings.share_image | default: shop.brand.logo -%}
{%- assign og_image_alt = settings.share_image.alt | default: shop.name -%}

{%- if request.page_type == 'product' -%}
  {%- assign og_type = 'product' -%}
  {%- assign og_title = product.title | strip_html | escape -%}
  {%- assign og_description = product.description | strip_html | truncate: 300 | escape -%}
  {%- if product.featured_media -%}
    {%- assign og_image = product.featured_media | image_url: width: 1200, height: 630 -%}
    {%- assign og_image_alt = product.featured_media.alt | default: product.title | escape -%}
  {%- endif -%}
{%- elsif request.page_type == 'article' -%}
  {%- assign og_type = 'article' -%}
  {%- assign og_title = article.title | strip_html | escape -%}
  {%- assign og_description = article.excerpt | default: article.content | strip_html | truncate: 300 | escape -%}
  {%- if article.image -%}
    {%- assign og_image = article.image | image_url: width: 1200, height: 630 -%}
    {%- assign og_image_alt = article.image.alt | default: article.title | escape -%}
  {%- endif -%}
{%- elsif request.page_type == 'collection' -%}
  {%- assign og_title = collection.title | strip_html | escape -%}
  {%- assign og_description = collection.description | default: collection.title | strip_html | truncate: 300 | escape -%}
  {%- if collection.featured_image -%}
    {%- assign og_image = collection.featured_image | image_url: width: 1200, height: 630 -%}
    {%- assign og_image_alt = collection.featured_image.alt | default: collection.title | escape -%}
  {%- endif -%}
{%- endif -%}

{%- comment -%} Open Graph Tags {%- endcomment -%}
<meta property="og:site_name" content="{{ shop.name }}">
<meta property="og:url" content="{{ og_url }}">
<meta property="og:title" content="{{ og_title }}">
<meta property="og:type" content="{{ og_type }}">
<meta property="og:description" content="{{ og_description }}">

{%- if og_image -%}
  <meta property="og:image" content="{{ og_image }}">
  <meta property="og:image:secure_url" content="{{ og_image }}">
  <meta property="og:image:alt" content="{{ og_image_alt }}">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
{%- endif -%}

{%- comment -%} Twitter Card Tags {%- endcomment -%}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ og_title }}">
<meta name="twitter:description" content="{{ og_description }}">

{%- if settings.social_twitter_link != blank -%}
  <meta name="twitter:site" content="{{ settings.social_twitter_link | split: 'twitter.com/' | last | prepend: '@' }}">
{%- endif -%}

{%- if og_image -%}
  <meta name="twitter:image" content="{{ og_image }}">
  <meta name="twitter:image:alt" content="{{ og_image_alt }}">
{%- endif -%}

{%- comment -%} Product-specific tags {%- endcomment -%}
{%- if request.page_type == 'product' -%}
  <meta property="product:price:amount" content="{{ product.selected_or_first_available_variant.price | money_without_currency | strip }}">
  <meta property="product:price:currency" content="{{ cart.currency.iso_code }}">
  <meta property="product:availability" content="{% if product.available %}in stock{% else %}out of stock{% endif %}">
  <meta property="product:condition" content="new">
  <meta property="product:retailer_item_id" content="{{ product.selected_or_first_available_variant.sku | default: product.selected_or_first_available_variant.id }}">
  
  {%- if product.vendor != blank -%}
    <meta property="product:brand" content="{{ product.vendor | escape }}">
  {%- endif -%}
  
  {%- comment -%} JSON-LD Product Schema {%- endcomment -%}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": {{ product.title | json }},
    "description": {{ product.description | strip_html | json }},
    "image": [
      {%- for media in product.media limit: 3 -%}
        "{{ media | image_url: width: 1200 }}"{% unless forloop.last %},{% endunless %}
      {%- endfor -%}
    ],
    "brand": {
      "@type": "Brand",
      "name": {{ product.vendor | default: shop.name | json }}
    },
    "offers": {
      "@type": "Offer",
      "url": "{{ shop.url }}{{ product.url }}",
      "priceCurrency": "{{ cart.currency.iso_code }}",
      "price": "{{ product.selected_or_first_available_variant.price | divided_by: 100.0 }}",
      "priceValidUntil": "{{ 'now' | date: '%Y-12-31' }}",
      "availability": "https://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
      "itemCondition": "https://schema.org/NewCondition",
      "seller": {
        "@type": "Organization",
        "name": {{ shop.name | json }}
      }
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "reviewCount": "127",
      "bestRating": "5",
      "worstRating": "1"
    }
  }
  </script>
{%- endif -%}

{%- comment -%} Article-specific tags {%- endcomment -%}
{%- if request.page_type == 'article' -%}
  <meta property="article:published_time" content="{{ article.published_at | date: '%Y-%m-%d' }}">
  <meta property="article:modified_time" content="{{ article.updated_at | date: '%Y-%m-%d' }}">
  <meta property="article:author" content="{{ article.author | default: shop.name }}">
  
  {%- for tag in article.tags -%}
    <meta property="article:tag" content="{{ tag }}">
  {%- endfor -%}
  
  {%- comment -%} JSON-LD Article Schema {%- endcomment -%}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": {{ article.title | json }},
    "description": {{ article.excerpt | default: article.content | strip_html | truncate: 300 | json }},
    "image": "{{ article.image | default: shop.brand.logo | image_url: width: 1200 }}",
    "author": {
      "@type": "Person",
      "name": {{ article.author | default: shop.name | json }}
    },
    "publisher": {
      "@type": "Organization",
      "name": {{ shop.name | json }},
      "logo": {
        "@type": "ImageObject",
        "url": "{{ shop.brand.logo | image_url: width: 600 }}"
      }
    },
    "datePublished": "{{ article.published_at | date: '%Y-%m-%d' }}",
    "dateModified": "{{ article.updated_at | date: '%Y-%m-%d' }}",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ shop.url }}{{ article.url }}"
    }
  }
  </script>
{%- endif -%}

{%- comment -%} Organization Schema {%- endcomment -%}
{%- if request.page_type == 'index' -%}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": {{ shop.name | json }},
    "url": "{{ shop.url }}",
    "logo": "{{ shop.brand.logo | image_url: width: 600 }}",
    "description": {{ shop.description | json }},
    "address": {
      "@type": "PostalAddress",
      "streetAddress": {{ shop.address.street | json }},
      "addressLocality": {{ shop.address.city | json }},
      "addressRegion": {{ shop.address.province | json }},
      "postalCode": {{ shop.address.zip | json }},
      "addressCountry": {{ shop.address.country | json }}
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": {{ shop.phone | json }},
      "contactType": "customer service"
    },
    "sameAs": [
      {%- if settings.social_facebook_link != blank -%}
        {{ settings.social_facebook_link | json }}{% unless settings.social_instagram_link == blank or settings.social_twitter_link == blank %},{% endunless %}
      {%- endif -%}
      {%- if settings.social_instagram_link != blank -%}
        {{ settings.social_instagram_link | json }}{% unless settings.social_twitter_link == blank %},{% endunless %}
      {%- endif -%}
      {%- if settings.social_twitter_link != blank -%}
        {{ settings.social_twitter_link | json }}
      {%- endif -%}
    ]
  }
  </script>
{%- endif -%}

{%- comment -%} Website Schema {%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": {{ shop.name | json }},
  "url": "{{ shop.url }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "{{ shop.url }}/search?q={search_term_string}"
    },
    "query-input": "required name=search_term_string"
  }
}
</script>

{%- comment -%} Additional SEO Meta Tags {%- endcomment -%}
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="googlebot" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

{%- comment -%} Mobile App Tags {%- endcomment -%}
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="{{ shop.name }}">

{%- comment -%} Theme Color {%- endcomment -%}
<meta name="theme-color" content="{{ settings.brand_primary | default: '#1a1a1a' }}">
<meta name="msapplication-navbutton-color" content="{{ settings.brand_primary | default: '#1a1a1a' }}">

{%- comment -%} Preload critical resources {%- endcomment -%}
<link rel="preload" href="{{ 'royal-equips.css' | asset_url }}" as="style">
<link rel="preload" href="{{ 'base.css' | asset_url }}" as="style">

{%- comment -%} DNS Prefetch {%- endcomment -%}
<link rel="dns-prefetch" href="//cdn.shopify.com">
<link rel="dns-prefetch" href="//fonts.shopifycdn.com">
<link rel="dns-prefetch" href="//monorail-edge.shopifysvc.com">

{%- comment -%} Preconnect to critical third-party origins {%- endcomment -%}
<link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
<link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>

{%- comment -%} Microsoft Edge/IE compatibility {%- endcomment -%}
<meta http-equiv="X-UA-Compatible" content="IE=edge">

{%- comment -%} Royal Equips brand verification (example) {%- endcomment -%}
{%- if settings.google_site_verification != blank -%}
  <meta name="google-site-verification" content="{{ settings.google_site_verification }}">
{%- endif -%}

{%- if settings.pinterest_site_verification != blank -%}
  <meta name="p:domain_verify" content="{{ settings.pinterest_site_verification }}">
{%- endif -%}